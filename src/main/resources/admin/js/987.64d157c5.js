"use strict";(self["webpackChunkhalo_admin"]=self["webpackChunkhalo_admin"]||[]).push([[987],{19987:function(e,r,t){t.r(r),t.d(r,{default:function(){return d}});var o=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"container-wrapper animated fadeIn"},[e._m(0),t("div",[t("a-form-model",{ref:"sendCodeForm",attrs:{model:e.form.model,rules:e.form.sendCodeRules,layout:"vertical"}},[t("a-form-model-item",{attrs:{prop:"username"}},[t("a-input",{attrs:{placeholder:"用户名"},model:{value:e.form.model.username,callback:function(r){e.$set(e.form.model,"username",r)},expression:"form.model.username"}},[t("a-icon",{staticStyle:{color:"rgba(0, 0, 0, 0.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),t("a-form-model-item",{attrs:{prop:"email"}},[t("a-input",{attrs:{placeholder:"邮箱"},model:{value:e.form.model.email,callback:function(r){e.$set(e.form.model,"email",r)},expression:"form.model.email"}},[t("a-icon",{staticStyle:{color:"rgba(0, 0, 0, 0.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1)],1),t("a-form-model",{ref:"passwordForm",attrs:{model:e.form.model,rules:e.form.rules,layout:"vertical"}},[t("a-form-model-item",{attrs:{prop:"code"}},[t("a-input",{attrs:{placeholder:"验证码",type:"password"},scopedSlots:e._u([{key:"addonAfter",fn:function(){return[t("a-button",{staticClass:"!p-0 !h-auto",attrs:{type:"link"},on:{click:e.handleSendCode}},[e._v("获取")])]},proxy:!0}]),model:{value:e.form.model.code,callback:function(r){e.$set(e.form.model,"code",r)},expression:"form.model.code"}},[t("a-icon",{staticStyle:{color:"rgba(0, 0, 0, 0.25)"},attrs:{slot:"prefix",type:"safety-certificate"},slot:"prefix"})],1)],1),t("a-form-model-item",{attrs:{prop:"password"}},[t("a-input",{attrs:{autocomplete:"new-password",placeholder:"新密码",type:"password"},model:{value:e.form.model.password,callback:function(r){e.$set(e.form.model,"password",r)},expression:"form.model.password"}},[t("a-icon",{staticStyle:{color:"rgba(0, 0, 0, 0.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),t("a-form-model-item",{attrs:{prop:"confirmPassword"}},[t("a-input",{attrs:{autocomplete:"new-password",placeholder:"确认密码",type:"password"},model:{value:e.form.model.confirmPassword,callback:function(r){e.$set(e.form.model,"confirmPassword",r)},expression:"form.model.confirmPassword"}},[t("a-icon",{staticStyle:{color:"rgba(0, 0, 0, 0.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),t("a-form-model-item",[t("a-button",{attrs:{block:!0,type:"primary"},on:{click:e.handleResetPassword}},[e._v("重置密码")])],1)],1),t("router-link",{staticClass:"tip",attrs:{to:{name:"Login"}}},[e._v(" 返回登录")])],1)])},a=[function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"halo-logo"},[t("img",{attrs:{alt:"Halo Logo",src:"/images/logo.svg"}}),t("span",[e._v("重置密码")])])}],s=t(46519),n=(t(70315),t(87591),t(18608)),l={data:function(){var e=this,r=function(r,t,o){t&&e.form.model.password!==t?o(new Error("确认密码与新密码不一致")):o()};return{form:{model:{},sendCodeRules:{username:[{required:!0,message:"* 用户名不能为空",trigger:["change"]}],email:[{required:!0,message:"* 电子邮箱地址不能为空",trigger:["change"]}]},rules:{code:[{required:!0,message:"* 验证码不能为空",trigger:["change"]}],password:[{required:!0,message:"* 新密码不能为空",trigger:["change"]},{max:100,min:8,message:"* 密码的字符长度必须在 8 - 100 之间",trigger:["change"]}],confirmPassword:[{required:!0,message:"* 确认密码不能为空",trigger:["change"]},{validator:r,trigger:["change"]}]}}}},methods:{handleSendCode:function(){var e=this;this.$refs.sendCodeForm.validate(function(){var r=(0,s.Z)(regeneratorRuntime.mark((function r(t){var o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!t){r.next=14;break}return o=e.$message.loading("发送中...",0),r.prev=2,r.next=5,n.Z.sendResetPasswordCode(e.form.model);case 5:e.$message.success("邮件发送成功，五分钟内有效"),r.next=11;break;case 8:r.prev=8,r.t0=r["catch"](2),e.$log.error("Failed send code: ",r.t0);case 11:return r.prev=11,o(),r.finish(11);case 14:case"end":return r.stop()}}),r,null,[[2,8,11,14]])})));return function(e){return r.apply(this,arguments)}}())},handleResetPassword:function(){var e=this;this.$refs.sendCodeForm.validate((function(r){r&&e.$refs.passwordForm.validate(function(){var r=(0,s.Z)(regeneratorRuntime.mark((function r(t){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!t){r.next=12;break}return r.prev=1,r.next=4,n.Z.resetPassword(e.form.model);case 4:return r.next=6,e.$router.push({name:"Login"});case 6:e.$message.success("密码重置成功！"),r.next=12;break;case 9:r.prev=9,r.t0=r["catch"](1),e.$log.error("Failed reset password: ",r.t0);case 12:case"end":return r.stop()}}),r,null,[[1,9]])})));return function(e){return r.apply(this,arguments)}}())}))}}},i=l,m=t(42177),c=(0,m.Z)(i,o,a,!1,null,null,null),d=c.exports}}]);