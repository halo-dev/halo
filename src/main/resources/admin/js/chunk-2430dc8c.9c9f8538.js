(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2430dc8c"],{"4cf8":function(a,t,e){"use strict";var n=e("7de1"),i=e.n(n);i.a},"61d0":function(a,t,e){"use strict";e.r(t);var n=function(){var a=this,t=this,e=t.$createElement,n=t._self._c||e;return n("page-view",[n("a-row",{attrs:{gutter:12,type:"flex",align:"middle"}},[n("a-col",{staticClass:"search-box",attrs:{span:24}},[n("a-card",{attrs:{bordered:!1}},[n("div",{staticClass:"table-page-search-wrapper"},[n("a-form",{attrs:{layout:"inline"}},[n("a-row",{attrs:{gutter:48}},[n("a-col",{attrs:{md:6,sm:24}},[n("a-form-item",{attrs:{label:"关键词"}},[n("a-input",{model:{value:t.queryParam.keyword,callback:function(a){t.$set(t.queryParam,"keyword",a)},expression:"queryParam.keyword"}})],1)],1),n("a-col",{attrs:{md:6,sm:24}},[n("a-form-item",{attrs:{label:"存储位置"}},[n("a-select",{on:{change:t.handleQuery},model:{value:t.queryParam.attachmentType,callback:function(a){t.$set(t.queryParam,"attachmentType",a)},expression:"queryParam.attachmentType"}},t._l(Object.keys(t.attachmentType),function(a){return n("a-select-option",{key:a,attrs:{value:a}},[t._v(t._s(t.attachmentType[a].text))])}),1)],1)],1),n("a-col",{attrs:{md:6,sm:24}},[n("a-form-item",{attrs:{label:"文件类型"}},[n("a-select",{on:{change:t.handleQuery},model:{value:t.queryParam.mediaType,callback:function(a){t.$set(t.queryParam,"mediaType",a)},expression:"queryParam.mediaType"}},t._l(t.mediaTypes,function(a,e){return n("a-select-option",{key:e,attrs:{value:a}},[t._v(t._s(a))])}),1)],1)],1),n("a-col",{attrs:{md:6,sm:24}},[n("span",{staticClass:"table-page-search-submitButtons"},[n("a-button",{attrs:{type:"primary"},on:{click:t.handleQuery}},[t._v("查询")]),n("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.handleResetParam}},[t._v("重置")])],1)])],1)],1)],1),n("div",{staticClass:"table-operator"},[n("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(){return a.uploadVisible=!0}}},[t._v("上传")])],1)])],1),n("a-col",{attrs:{span:24}},[n("a-list",{attrs:{grid:{gutter:12,xs:1,sm:2,md:4,lg:6,xl:6,xxl:6},dataSource:t.formattedDatas,loading:t.listLoading},scopedSlots:t._u([{key:"renderItem",fn:function(a,e){return n("a-list-item",{key:e},[n("a-card",{attrs:{bodyStyle:{padding:0},hoverable:""},on:{click:function(e){return t.handleShowDetailDrawer(a)}}},[n("div",{staticClass:"attach-thumb"},[n("span",{directives:[{name:"show",rawName:"v-show",value:!t.handleJudgeMediaType(a),expression:"!handleJudgeMediaType(item)"}]},[t._v("当前格式不支持预览")]),n("img",{directives:[{name:"show",rawName:"v-show",value:t.handleJudgeMediaType(a),expression:"handleJudgeMediaType(item)"}],attrs:{src:a.thumbPath}})]),n("a-card-meta",[n("ellipsis",{attrs:{slot:"description",length:t.isMobile()?36:16,tooltip:""},slot:"description"},[t._v(t._s(a.name))])],1)],1)],1)}}])})],1)],1),n("div",{staticClass:"page-wrapper"},[n("a-pagination",{staticClass:"pagination",attrs:{total:t.pagination.total,defaultPageSize:t.pagination.size,pageSizeOptions:["18","36","54","72","90","108"],showSizeChanger:""},on:{change:t.handlePaginationChange,showSizeChange:t.handlePaginationChange}})],1),n("a-modal",{attrs:{title:"上传附件",footer:null,afterClose:t.onUploadClose},model:{value:t.uploadVisible,callback:function(a){t.uploadVisible=a},expression:"uploadVisible"}},[n("upload",{attrs:{name:"file",multiple:"",uploadHandler:t.uploadHandler}},[n("p",{staticClass:"ant-upload-drag-icon"},[n("a-icon",{attrs:{type:"inbox"}})],1),n("p",{staticClass:"ant-upload-text"},[t._v("点击选择文件或将文件拖拽到此处")]),n("p",{staticClass:"ant-upload-hint"},[t._v("支持单个或批量上传")])])],1),t.selectAttachment?n("AttachmentDetailDrawer",{attrs:{attachment:t.selectAttachment,addToPhoto:!0},on:{delete:function(){return a.loadAttachments()}},model:{value:t.drawerVisiable,callback:function(a){t.drawerVisiable=a},expression:"drawerVisiable"}}):t._e()],1)},i=[],s=(e("7bc1"),e("b745"),e("680ad")),r=e("ac0d"),l=e("5bcf"),o=e("a796"),c={components:{PageView:s["b"],AttachmentDetailDrawer:l["a"]},mixins:[r["a"],r["b"]],data:function(){return{attachmentType:o["a"].type,listLoading:!0,uploadVisible:!1,selectAttachment:{},attachments:[],mediaTypes:[],editable:!1,pagination:{page:1,size:18,sort:null},queryParam:{page:0,size:18,sort:null,keyword:null,mediaType:null,attachmentType:null},uploadHandler:o["a"].upload,drawerVisiable:!1}},computed:{formattedDatas:function(){var a=this;return this.attachments.map(function(t){return t.typeProperty=a.attachmentType[t.type],t})}},created:function(){this.loadAttachments(),this.loadMediaTypes()},methods:{loadAttachments:function(){var a=this;this.queryParam.page=this.pagination.page-1,this.queryParam.size=this.pagination.size,this.queryParam.sort=this.pagination.sort,this.listLoading=!0,o["a"].query(this.queryParam).then(function(t){a.attachments=t.data.data.content,a.pagination.total=t.data.data.total,a.listLoading=!1})},loadMediaTypes:function(){var a=this;o["a"].getMediaTypes().then(function(t){a.mediaTypes=t.data.data})},handleShowDetailDrawer:function(a){this.selectAttachment=a,this.drawerVisiable=!0},handlePaginationChange:function(a,t){this.$log.debug("Current: ".concat(a,", PageSize: ").concat(t)),this.pagination.page=a,this.pagination.size=t,this.loadAttachments()},handleResetParam:function(){this.queryParam.keyword=null,this.queryParam.mediaType=null,this.queryParam.attachmentType=null,this.loadAttachments()},handleQuery:function(){this.queryParam.page=0,this.loadAttachments()},onUploadClose:function(){this.loadAttachments(),this.loadMediaTypes()},handleJudgeMediaType:function(a){var t=a.mediaType;if(t){var e=t.split("/")[0];return"image"===e}return!1}}},d=c,u=(e("4cf8"),e("17cc")),p=Object(u["a"])(d,n,i,!1,null,"604cba98",null);t["default"]=p.exports},"7de1":function(a,t,e){}}]);