(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3939e374"],{"307b":function(t,e,a){"use strict";var s=a("6fda"),o=a.n(s);o.a},3993:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-drawer",{attrs:{title:t.title,width:t.isMobile()?"100%":t.drawerWidth,closable:"",visible:t.visiable,destroyOnClose:""},on:{close:t.onClose}},[a("a-row",{attrs:{type:"flex",align:"middle"}},[a("a-input-search",{attrs:{placeholder:"搜索附件",enterButton:""}})],1),a("a-divider"),a("a-row",{attrs:{type:"flex",align:"middle"}},[a("a-skeleton",{attrs:{active:"",loading:t.skeletonLoading,paragraph:{rows:18}}},[a("a-col",{attrs:{span:24}},t._l(t.attachments,function(e,s){return a("div",{key:s,staticClass:"attach-item",on:{click:function(a){return t.handleSelectAttachment(e)}}},[a("img",{attrs:{src:e.thumbPath}})])}),0)],1)],1),a("a-divider"),a("div",{staticClass:"page-wrapper"},[a("a-pagination",{attrs:{defaultPageSize:t.pagination.size,total:t.pagination.total},on:{change:t.handlePaginationChange}})],1),a("a-divider",{staticClass:"divider-transparent"}),a("div",{staticClass:"bottom-control"},[t.isChooseAvatar?a("a-button",{staticStyle:{marginRight:"8px"},attrs:{type:"dashed"},on:{click:t.handleSelectGravatar}},[t._v("使用 Gravatar")]):t._e(),a("a-button",{attrs:{type:"primary"},on:{click:t.handleShowUploadModal}},[t._v("上传附件")])],1)],1),a("a-modal",{attrs:{title:"上传附件",footer:null,afterClose:t.onUploadClose},model:{value:t.uploadVisible,callback:function(e){t.uploadVisible=e},expression:"uploadVisible"}},[a("upload",{attrs:{name:"file",multiple:"",uploadHandler:t.attachmentUploadHandler}},[a("p",{staticClass:"ant-upload-drag-icon"},[a("a-icon",{attrs:{type:"inbox"}})],1),a("p",{staticClass:"ant-upload-text"},[t._v("点击选择文件或将文件拖拽到此处")]),a("p",{staticClass:"ant-upload-hint"},[t._v("支持单个或批量上传")])])],1)],1)},o=[],n=(a("d4d5"),a("ac0d")),r=a("a796"),i={name:"AttachmentSelectDrawer",mixins:[n["a"],n["b"]],model:{prop:"visiable",event:"close"},props:{visiable:{type:Boolean,required:!1,default:!1},drawerWidth:{type:Number,required:!1,default:460},title:{type:String,required:!1,default:"选择附件"},isChooseAvatar:{type:Boolean,required:!1,default:!1}},data:function(){return{uploadVisible:!1,skeletonLoading:!0,pagination:{page:1,size:12,sort:""},attachments:[],attachmentUploadHandler:r["a"].upload}},created:function(){this.loadSkeleton(),this.loadAttachments()},watch:{visiable:function(t,e){t&&this.loadSkeleton()}},methods:{loadSkeleton:function(){var t=this;this.skeletonLoading=!0,setTimeout(function(){t.skeletonLoading=!1},500)},handleShowUploadModal:function(){this.uploadVisible=!0},loadAttachments:function(){var t=this,e=Object.assign({},this.pagination);e.page--,r["a"].query(e).then(function(e){t.attachments=e.data.data.content,t.pagination.total=e.data.data.total})},handleSelectAttachment:function(t){this.$emit("listenToSelect",t)},handleSelectGravatar:function(){this.$emit("listenToSelectGravatar")},handlePaginationChange:function(t,e){this.pagination.page=t,this.pagination.size=e,this.loadAttachments()},handleAttachmentUploadSuccess:function(){this.$message.success("上传成功！"),this.loadAttachments()},onUploadClose:function(){this.loadSkeleton(),this.loadAttachments()},onClose:function(){this.$emit("close",!1)}}},c=i,l=(a("307b"),a("17cc")),d=Object(l["a"])(c,s,o,!1,null,null,null);e["a"]=d.exports},"5d17":function(t,e,a){"use strict";var s=a("e032"),o=a.n(s);o.a},"6fda":function(t,e,a){},a796:function(t,e,a){"use strict";var s=a("f753"),o=a.n(s),n=a("9efd"),r="/api/admin/attachments",i={query:function(t){return Object(n["a"])({url:r,params:t,method:"get"})},get:function(t){return Object(n["a"])({url:"".concat(r,"/").concat(t),method:"get"})},delete:function(t){return Object(n["a"])({url:"".concat(r,"/").concat(t),method:"delete"})},update:function(t,e){return Object(n["a"])({url:"".concat(r,"/").concat(t),method:"put",data:e})},getMediaTypes:function(){return Object(n["a"])({url:"".concat(r,"/media_types"),method:"get"})}};i.CancelToken=o.a.CancelToken,i.isCancel=o.a.isCancel,i.upload=function(t,e,a){return Object(n["a"])({url:"".concat(r,"/upload"),timeout:864e4,data:t,onUploadProgress:e,cancelToken:a,method:"post"})},i.uploads=function(t,e,a){return Object(n["a"])({url:"".concat(r,"/uploads"),timeout:864e4,data:t,onUploadProgress:e,cancelToken:a,method:"post"})},i.type={LOCAL:{type:"local",text:"本地"},SMMS:{type:"smms",text:"SM.MS"},UPYUN:{type:"upyun",text:"又拍云"},QNYUN:{type:"qnyun",text:"七牛云"},ALIYUN:{type:"aliyun",text:"阿里云"}},e["a"]=i},c405:function(t,e,a){"use strict";a("7364"),a("f763");var s=a("9efd"),o="/api/admin/categories",n={};function r(t,e){e.forEach(function(e){t.key===e.parentId&&(t.children||(t.children=[]),t.children.push({key:e.id,title:e.name,isLeaf:!1}))}),t.children?t.children.forEach(function(t){return r(t,e)}):t.isLeaf=!0}n.listAll=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(s["a"])({url:"".concat(o),params:{more:t},method:"get"})},n.listTree=function(){return Object(s["a"])({url:"".concat(o,"/tree_view"),method:"get"})},n.create=function(t){return Object(s["a"])({url:o,data:t,method:"post"})},n.delete=function(t){return Object(s["a"])({url:"".concat(o,"/").concat(t),method:"delete"})},n.get=function(t){return Object(s["a"])({url:"".concat(o,"/").concat(t),method:"get"})},n.update=function(t,e){return Object(s["a"])({url:"".concat(o,"/").concat(t),data:e,method:"put"})},n.concreteTree=function(t){var e={key:0,title:"top",children:[]};return r(e,t),e.children},e["a"]=n},caf6:function(t,e,a){"use strict";var s=a("9efd"),o="/api/admin/posts",n={listLatest:function(t){return Object(s["a"])({url:"".concat(o,"/latest"),params:{top:t},method:"get"})},query:function(t){return Object(s["a"])({url:o,params:t,method:"get"})},get:function(t){return Object(s["a"])({url:"".concat(o,"/").concat(t),method:"get"})},create:function(t,e){return Object(s["a"])({url:o,method:"post",data:t,mute:e,params:{autoSave:e}})},update:function(t,e,a){return Object(s["a"])({url:"".concat(o,"/").concat(t),method:"put",data:e,params:{autoSave:a}})},updateStatus:function(t,e){return Object(s["a"])({url:"".concat(o,"/").concat(t,"/status/").concat(e),method:"put"})},delete:function(t){return Object(s["a"])({url:"".concat(o,"/").concat(t),method:"delete"})},postStatus:{PUBLISHED:{color:"green",status:"success",text:"已发布"},DRAFT:{color:"yellow",status:"warning",text:"草稿"},RECYCLE:{color:"red",status:"error",text:"回收站"}}};e["a"]=n},d28d:function(t,e,a){"use strict";var s=a("9efd"),o="/api/admin/tags",n={listAll:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(s["a"])({url:o,params:{more:t},method:"get"})},createWithName:function(t){return Object(s["a"])({url:o,data:{name:t},method:"post"})},create:function(t){return Object(s["a"])({url:o,data:t,method:"post"})},update:function(t,e){return Object(s["a"])({url:"".concat(o,"/").concat(t),data:e,method:"put"})},delete:function(t){return Object(s["a"])({url:"".concat(o,"/").concat(t),method:"delete"})}};e["a"]=n},dae2:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"page-header-index-wide"},[s("a-card",{attrs:{bordered:!1}},[s("div",{staticClass:"table-page-search-wrapper"},[s("a-form",{attrs:{layout:"inline"}},[s("a-row",{attrs:{gutter:48}},[s("a-col",{attrs:{md:6,sm:24}},[s("a-form-item",{attrs:{label:"关键词"}},[s("a-input",{model:{value:e.queryParam.keyword,callback:function(t){e.$set(e.queryParam,"keyword",t)},expression:"queryParam.keyword"}})],1)],1),s("a-col",{attrs:{md:6,sm:24}},[s("a-form-item",{attrs:{label:"文章状态"}},[s("a-select",{attrs:{placeholder:"请选择文章状态"},on:{change:e.handleQuery},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}},e._l(Object.keys(e.postStatus),function(t){return s("a-select-option",{key:t,attrs:{value:t}},[e._v(e._s(e.postStatus[t].text))])}),1)],1)],1),s("a-col",{attrs:{md:6,sm:24}},[s("a-form-item",{attrs:{label:"分类目录"}},[s("a-select",{attrs:{placeholder:"请选择分类"},on:{change:e.handleQuery},model:{value:e.queryParam.categoryId,callback:function(t){e.$set(e.queryParam,"categoryId",t)},expression:"queryParam.categoryId"}},e._l(e.categories,function(t){return s("a-select-option",{key:t.id},[e._v(e._s(t.name))])}),1)],1)],1),s("a-col",{attrs:{md:6,sm:24}},[s("span",{staticClass:"table-page-search-submitButtons"},[s("a-button",{attrs:{type:"primary"},on:{click:e.handleQuery}},[e._v("查询")]),s("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.handleResetParam}},[e._v("重置")])],1)])],1)],1)],1),s("div",{staticClass:"table-operator"},[s("router-link",{attrs:{to:{name:"PostEdit"}}},[s("a-button",{attrs:{type:"primary",icon:"plus"}},[e._v("写文章")])],1),s("a-dropdown",{directives:[{name:"show",rawName:"v-show",value:null!=e.queryParam.status&&""!=e.queryParam.status,expression:"queryParam.status!=null && queryParam.status!=''"}]},[s("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},["DRAFT"===e.queryParam.status?s("a-menu-item",{key:"1"},[s("a",{attrs:{href:"javascript:void(0);"},on:{click:e.handlePublishMore}},[s("span",[e._v("发布")])])]):e._e(),"PUBLISHED"===e.queryParam.status||"DRAFT"===e.queryParam.status?s("a-menu-item",{key:"2"},[s("a",{attrs:{href:"javascript:void(0);"},on:{click:e.handleRecycleMore}},[s("span",[e._v("移到回收站")])])]):e._e(),"RECYCLE"===e.queryParam.status?s("a-menu-item",{key:"3"},[s("a",{attrs:{href:"javascript:void(0);"},on:{click:e.handleDeleteMore}},[s("span",[e._v("永久删除")])])]):e._e()],1),s("a-button",{staticStyle:{"margin-left":"8px"}},[e._v("\n          批量操作\n          "),s("a-icon",{attrs:{type:"down"}})],1)],1)],1),s("div",{staticStyle:{"margin-top":"15px"}},[s("a-table",{attrs:{rowKey:function(t){return t.id},rowSelection:{onChange:e.onSelectionChange,getCheckboxProps:e.getCheckboxProps},columns:e.columns,dataSource:e.formattedPosts,loading:e.postsLoading,pagination:!1},scopedSlots:e._u([{key:"postTitle",fn:function(t,a){return s("span",{staticClass:"post-title"},[s("a",{attrs:{href:e.options.blog_url+"/archives/"+a.url,target:"_blank"}},[s("a-tooltip",{attrs:{placement:"topLeft",title:"点击预览 "+t}},[e._v(e._s(t))])],1)])}},{key:"status",fn:function(t){return s("span",{},[s("a-badge",{attrs:{status:t.status}}),e._v("\n          "+e._s(t.text)+"\n        ")],1)}},{key:"categories",fn:function(t){return s("span",{},e._l(t,function(t,a){return s("a-tag",{key:a,attrs:{color:"blue"}},[e._v(e._s(t.name))])}),1)}},{key:"tags",fn:function(t){return s("span",{},e._l(t,function(t,a){return s("a-tag",{key:a,attrs:{color:"green"}},[e._v(e._s(t.name))])}),1)}},{key:"updateTime",fn:function(t){return s("span",{},[e._v(e._s(e._f("timeAgo")(t)))])}},{key:"action",fn:function(t,a){return s("span",{},["PUBLISHED"===a.status||"DRAFT"===a.status?s("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.handleEditClick(a)}}},[e._v("编辑")]):"RECYCLE"===a.status?s("a-popconfirm",{attrs:{title:"你确定要发布【"+a.title+"】文章？",okText:"确定",cancelText:"取消"},on:{confirm:function(t){return e.handleEditStatusClick(a.id,"PUBLISHED")}}},[s("a",{attrs:{href:"javascript:;"}},[e._v("还原")])]):e._e(),s("a-divider",{attrs:{type:"vertical"}}),"PUBLISHED"===a.status||"DRAFT"===a.status?s("a-popconfirm",{attrs:{title:"你确定要将【"+a.title+"】文章移到回收站？",okText:"确定",cancelText:"取消"},on:{confirm:function(t){return e.handleEditStatusClick(a.id,"RECYCLE")}}},[s("a",{attrs:{href:"javascript:;"}},[e._v("回收站")])]):"RECYCLE"===a.status?s("a-popconfirm",{attrs:{title:"你确定要永久删除【"+a.title+"】文章？",okText:"确定",cancelText:"取消"},on:{confirm:function(t){return e.handleDeleteClick(a.id)}}},[s("a",{attrs:{href:"javascript:;"}},[e._v("删除")])]):e._e(),s("a-divider",{attrs:{type:"vertical"}}),s("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.handlePostSettingsDrawer(a)}}},[e._v("设置")])],1)}}])}),s("div",{staticClass:"page-wrapper"},[s("a-pagination",{staticClass:"pagination",attrs:{total:e.pagination.total,pageSizeOptions:["1","2","5","10","20","50","100"],showSizeChanger:""},on:{showSizeChange:e.handlePaginationChange,change:e.handlePaginationChange}})],1)],1)]),s("a-drawer",{attrs:{title:"文章设置",width:e.isMobile()?"100%":"460",placement:"right",closable:"",visible:e.postSettingVisible},on:{close:e.onPostSettingsClose}},[s("div",{staticClass:"post-setting-drawer-content"},[s("div",{style:{marginBottom:"16px"}},[s("h3",{staticClass:"post-setting-drawer-title"},[e._v("基本设置")]),s("div",{staticClass:"post-setting-drawer-item"},[s("a-form",{attrs:{layout:"vertical"}},[s("a-form-item",{attrs:{label:"文章标题："}},[s("a-input",{model:{value:e.selectedPost.title,callback:function(t){e.$set(e.selectedPost,"title",t)},expression:"selectedPost.title"}})],1),s("a-form-item",{attrs:{label:"文章路径：",help:e.options.blog_url+"/archives/"+(e.selectedPost.url?e.selectedPost.url:"{auto_generate}")}},[s("a-input",{model:{value:e.selectedPost.url,callback:function(t){e.$set(e.selectedPost,"url",t)},expression:"selectedPost.url"}})],1),s("a-form-item",{attrs:{label:"开启评论："}},[s("a-radio-group",{attrs:{defaultValue:!1},model:{value:e.selectedPost.disallowComment,callback:function(t){e.$set(e.selectedPost,"disallowComment",t)},expression:"selectedPost.disallowComment"}},[s("a-radio",{attrs:{value:!1}},[e._v("开启")]),s("a-radio",{attrs:{value:!0}},[e._v("关闭")])],1)],1)],1)],1)]),s("a-divider"),s("div",{style:{marginBottom:"16px"}},[s("h3",{staticClass:"post-setting-drawer-title"},[e._v("分类目录")]),s("div",{staticClass:"post-setting-drawer-item"},[s("category-tree",{attrs:{categories:e.categories},model:{value:e.selectedCategoryIds,callback:function(t){e.selectedCategoryIds=t},expression:"selectedCategoryIds"}}),s("div",[s("a-form",{attrs:{layout:"vertical"}},[e.categoryForm?s("a-form-item",[s("category-select-tree",{attrs:{categories:e.categories},model:{value:e.categoryToCreate.parentId,callback:function(t){e.$set(e.categoryToCreate,"parentId",t)},expression:"categoryToCreate.parentId"}})],1):e._e(),e.categoryForm?s("a-form-item",[s("a-input",{attrs:{placeholder:"分类名称"},model:{value:e.categoryToCreate.name,callback:function(t){e.$set(e.categoryToCreate,"name",t)},expression:"categoryToCreate.name"}})],1):e._e(),e.categoryForm?s("a-form-item",[s("a-input",{attrs:{placeholder:"分类路径"},model:{value:e.categoryToCreate.slugNames,callback:function(t){e.$set(e.categoryToCreate,"slugNames",t)},expression:"categoryToCreate.slugNames"}})],1):e._e(),s("a-form-item",[e.categoryForm?s("a-button",{staticStyle:{marginRight:"8px"},attrs:{type:"primary"},on:{click:e.handlerCreateCategory}},[e._v("保存")]):e._e(),e.categoryForm?e._e():s("a-button",{staticStyle:{marginRight:"8px"},attrs:{type:"dashed"},on:{click:e.toggleCategoryForm}},[e._v("新增")]),e.categoryForm?s("a-button",{on:{click:e.toggleCategoryForm}},[e._v("取消")]):e._e()],1)],1)],1)],1)]),s("a-divider"),s("div",{style:{marginBottom:"16px"}},[s("h3",{staticClass:"post-setting-drawer-title"},[e._v("标签")]),s("div",{staticClass:"post-setting-drawer-item"},[s("a-form",{attrs:{layout:"vertical"}},[s("a-form-item",[s("TagSelect",{model:{value:e.selectedTagIds,callback:function(t){e.selectedTagIds=t},expression:"selectedTagIds"}})],1)],1)],1)]),s("a-divider"),s("div",{style:{marginBottom:"16px"}},[s("h3",{staticClass:"post-setting-drawer-title"},[e._v("摘要")]),s("div",{staticClass:"post-setting-drawer-item"},[s("a-form",{attrs:{layout:"vertical"}},[s("a-form-item",[s("a-input",{attrs:{type:"textarea",autosize:{minRows:5},placeholder:"不填写则会自动生成"},model:{value:e.selectedPost.summary,callback:function(t){e.$set(e.selectedPost,"summary",t)},expression:"selectedPost.summary"}})],1)],1)],1)]),s("a-divider"),s("div",{style:{marginBottom:"16px"}},[s("h3",{staticClass:"post-setting-drawer-title"},[e._v("缩略图")]),s("div",{staticClass:"post-setting-drawer-item"},[s("div",{staticClass:"post-thum"},[s("img",{staticClass:"img",attrs:{src:e.selectedPost.thumbnail||"//i.loli.net/2019/05/05/5ccf007c0a01d.png"},on:{click:function(){return t.thumDrawerVisible=!0}}}),s("a-button",{staticClass:"post-thum-remove",attrs:{type:"dashed"},on:{click:e.handlerRemoveThumb}},[e._v("移除")])],1)])]),s("a-divider",{staticClass:"divider-transparent"})],1),s("AttachmentSelectDrawer",{attrs:{drawerWidth:460},on:{listenToSelect:e.handleSelectPostThumb},model:{value:e.thumDrawerVisible,callback:function(t){e.thumDrawerVisible=t},expression:"thumDrawerVisible"}}),s("div",{staticClass:"bottom-control"},[s("a-button",{attrs:{type:"primary"},on:{click:e.handleSavePostSettingsClick}},[e._v("保存")])],1)],1)],1)},o=[],n=(a("f763"),a("b745"),a("c405")),r=a("caf6"),i=a("482b"),c=a("ac0d"),l=a("3993"),d=a("edf6"),u=a("eda3"),h=[{title:"标题",dataIndex:"title",width:"150px",scopedSlots:{customRender:"postTitle"}},{title:"状态",className:"status",dataIndex:"statusProperty",scopedSlots:{customRender:"status"}},{title:"分类目录",dataIndex:"categories",scopedSlots:{customRender:"categories"}},{title:"标签",dataIndex:"tags",scopedSlots:{customRender:"tags"}},{title:"评论量",dataIndex:"commentCount"},{title:"访问量",dataIndex:"visits"},{title:"更新时间",dataIndex:"updateTime",scopedSlots:{customRender:"updateTime"}},{title:"操作",width:"180px",scopedSlots:{customRender:"action"}}],m={name:"PostList",components:{AttachmentSelectDrawer:l["a"],TagSelect:d["a"],CategoryTree:u["a"]},mixins:[c["a"],c["b"]],data:function(){return{postStatus:r["a"].postStatus,pagination:{current:1,pageSize:10,sort:null},queryParam:{page:0,size:10,sort:null,keyword:null,categoryId:null,status:null},columns:h,selectedRowKeys:[],selectedRows:[],categories:[],posts:[],postsLoading:!1,postSettingVisible:!1,thumDrawerVisible:!1,selectedPost:{},selectedCategoryIds:[],selectedTagIds:[],categoryForm:!1,categoryToCreate:{},options:[],keys:["blog_url"]}},computed:{formattedPosts:function(){var t=this;return this.posts.map(function(e){return e.statusProperty=t.postStatus[e.status],e})}},created:function(){this.loadCategories(),this.loadPosts(),this.loadOptions()},methods:{loadPosts:function(){var t=this;this.postsLoading=!0,this.queryParam.page=this.pagination.current-1,this.queryParam.size=this.pagination.pageSize,this.queryParam.sort=this.pagination.sort,r["a"].query(this.queryParam).then(function(e){t.posts=e.data.data.content,t.pagination.total=e.data.data.total,t.postsLoading=!1})},loadCategories:function(){var t=this;n["a"].listAll().then(function(e){t.categories=e.data.data})},loadOptions:function(){var t=this;i["a"].listAll(this.keys).then(function(e){t.options=e.data.data})},handleEditClick:function(t){this.$router.push({name:"PostEdit",query:{postId:t.id}})},onSelectionChange:function(t){this.selectedRowKeys=t,this.$log.debug("SelectedRowKeys: ".concat(t))},getCheckboxProps:function(t){return{props:{disabled:"RECYCLE"===t.status,name:t.title}}},handlePaginationChange:function(t,e){this.$log.debug("Current: ".concat(t,", PageSize: ").concat(e)),this.pagination.current=t,this.pagination.pageSize=e,this.loadPosts()},handleResetParam:function(){this.queryParam.keyword=null,this.queryParam.categoryId=null,this.queryParam.status=null,this.loadPosts()},handleQuery:function(){this.queryParam.page=0,this.loadPosts()},handleEditStatusClick:function(t,e){var a=this;r["a"].updateStatus(t,e).then(function(t){a.$message.success("操作成功！"),a.loadPosts()})},handleDeleteClick:function(t){var e=this;r["a"].delete(t).then(function(t){e.$message.success("删除成功！"),e.loadPosts()})},handlePublishMore:function(){var t=this;if(this.selectedRowKeys.length<=0)this.$message.success("请至少选择一项！");else for(var e=function(e){var a=t.selectedRowKeys[e];r["a"].updateStatus(a,"PUBLISHED").then(function(e){t.$log.debug("postId: ".concat(a,", status: PUBLISHED")),t.selectedRowKeys=[],t.loadPosts()})},a=0;a<this.selectedRowKeys.length;a++)e(a)},handleRecycleMore:function(){var t=this;if(this.selectedRowKeys.length<=0)this.$message.success("请至少选择一项！");else for(var e=function(e){var a=t.selectedRowKeys[e];r["a"].updateStatus(a,"RECYCLE").then(function(e){t.$log.debug("postId: ".concat(a,", status: RECYCLE")),t.selectedRowKeys=[],t.loadPosts()})},a=0;a<this.selectedRowKeys.length;a++)e(a)},handleDeleteMore:function(){var t=this;if(this.selectedRowKeys.length<=0)this.$message.success("请至少选择一项！");else for(var e=function(e){var a=t.selectedRowKeys[e];r["a"].delete(a).then(function(e){t.$log.debug("delete: ".concat(a)),t.selectedRowKeys=[],t.loadPosts()})},a=0;a<this.selectedRowKeys.length;a++)e(a)},handlePostSettingsDrawer:function(t){var e=this;this.postSettingVisible=!0,r["a"].get(t.id).then(function(t){var a=t.data.data;e.selectedPost=a,e.selectedTagIds=a.tagIds,e.selectedCategoryIds=a.categoryIds})},handleSelectPostThumb:function(t){this.selectedPost.thumbnail=t.path,this.thumDrawerVisible=!1},handlerRemoveThumb:function(){this.selectedPost.thumbnail=null},handleSavePostSettingsClick:function(){var t=this;this.selectedPost.categoryIds=this.selectedCategoryIds,this.selectedPost.tagIds=this.selectedTagIds,r["a"].update(this.selectedPost.id,this.selectedPost,!1).then(function(e){t.$log.debug("Updated post",e.data.data),t.loadPosts(),t.$message.success("文章更新成功")})},toggleCategoryForm:function(){this.categoryForm=!this.categoryForm},handlerCreateCategory:function(){var t=this;n["a"].create(this.categoryToCreate).then(function(e){t.loadCategories(),t.categoryToCreate={}})},onPostSettingsClose:function(){this.postSettingVisible=!1,this.selectedPost={},this.selectedTagIds=[],this.selectedCategoryIds=[]}}},p=m,g=(a("5d17"),a("17cc")),f=Object(g["a"])(p,s,o,!1,null,"a379d92e",null);e["default"]=f.exports},e032:function(t,e,a){},eda3:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-tree",{attrs:{checkable:"",treeData:t.categoryTree,defaultExpandAll:!0,checkedKeys:t.categoryIds},on:{check:t.onCheck}},[a("span",{staticStyle:{color:"#1890ff"},attrs:{slot:"title0010"},slot:"title0010"},[t._v("sss")])])},o=[],n=a("c405"),r={name:"CategoryTree",model:{prop:"categoryIds",event:"check"},props:{categoryIds:{type:Array,required:!1,default:function(){return[]}},categories:{type:Array,required:!1,default:function(){return[]}}},computed:{categoryTree:function(){return n["a"].concreteTree(this.categories)}},methods:{onCheck:function(t,e){this.$log.debug("Chekced keys",t),this.$log.debug("e",e);var a=e.checkedNodes.filter(function(t){return t.data.props.isLeaf}).map(function(t){return t.key});this.$log.debug("Effectively selected category ids",a),this.$emit("check",a)}}},i=r,c=a("17cc"),l=Object(c["a"])(i,s,o,!1,null,null,null);e["a"]=l.exports},edf6:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-select",{staticStyle:{width:"100%"},attrs:{allowClear:"",mode:"tags",placeholder:"选择或输入标签"},on:{blur:t.handleBlur},model:{value:t.selectedTagNames,callback:function(e){t.selectedTagNames=e},expression:"selectedTagNames"}},t._l(t.tags,function(e){return a("a-select-option",{key:e.id,attrs:{value:e.name}},[t._v(t._s(e.name))])}),1)],1)},o=[],n=(a("f763"),a("7364"),a("d28d")),r=a("f753"),i=a.n(r),c={name:"TagSelect",model:{prop:"tagIds",event:"change"},props:{tagIds:{type:Array,required:!1,default:function(){return[]}}},data:function(){return{tags:[],selectedTagNames:[]}},created:function(){this.loadTags()},watch:{tags:function(t,e){var a=this;t&&(this.selectedTagNames=this.tagIds.map(function(t){return a.tagIdMap[t].name}))}},computed:{tagIdMap:function(){var t={};return this.tags.forEach(function(e){t[e.id]=e}),t},tagNameMap:function(){var t={};return this.tags.forEach(function(e){t[e.name]=e}),t}},methods:{loadTags:function(t){var e=this;n["a"].listAll(!0).then(function(a){e.tags=a.data.data,t&&t()})},handleBlur:function(){var t=this;this.$log.debug("Blured");var e=this.selectedTagNames.filter(function(e){return!t.tagNameMap[e]});if(this.$log.debug("Tag names to create",e),e!==[]){var a=e.map(function(t){return n["a"].createWithName(t)});i.a.all(a).then(i.a.spread(function(){t.loadTags(function(){t.$log.debug("Tag name map",t.tagNameMap);var e=t.selectedTagNames.map(function(e){return t.tagNameMap[e].id});t.$emit("change",e)})}))}else{var s=this.selectedTagNames.map(function(e){return t.tagNameMap[e].id});this.$emit("change",s)}}}},l=c,d=a("17cc"),u=Object(d["a"])(l,s,o,!1,null,null,null);e["a"]=u.exports}}]);