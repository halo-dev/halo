(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54b9a860"],{4275:function(t,a,e){},a9aa:function(t,a,e){"use strict";var n=e("4275"),o=e.n(n);o.a},db98:function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"page-header-index-wide"},[e("div",{staticClass:"card-content"},[e("a-row",{attrs:{gutter:12}},[e("a-col",{attrs:{xl:12,lg:12,md:24,sm:24,xs:24}},[e("backup")],1),e("a-col",{attrs:{xl:6,lg:6,md:12,sm:24,xs:24}},[e("a-card",{attrs:{bordered:!1,bodyStyle:{padding:"16px"}}},[e("div",{attrs:{slot:"title"},slot:"title"},[e("a-icon",{attrs:{type:"file-markdown"}}),t._v("Markdown 文章导入\n          ")],1),e("p",[t._v("支持 Hexo/Jekyll 文章导入并解析元数据")]),e("a-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.handleImportMarkdown}},[t._v("导入")])],1)],1)],1),e("a-modal",{attrs:{title:"Markdown 文章导入",footer:null,destroyOnClose:"",afterClose:t.onUploadClose},model:{value:t.markdownUpload,callback:function(a){t.markdownUpload=a},expression:"markdownUpload"}},[e("FilePondUpload",{ref:"upload",attrs:{name:"file",accept:"text/markdown",label:"拖拽或点击选择 Markdown 文件到此处",uploadHandler:t.uploadHandler}})],1)],1)])},o=[],l=(e("7f7f"),e("9efd")),i="/api/admin/backups",s={importMarkdown:function(t,a,e){return Object(l["a"])({url:"".concat(i,"/import/markdown"),timeout:864e4,data:t,onUploadProgress:a,cancelToken:e,method:"post"})},backupHalo:function(){return Object(l["a"])({url:"".concat(i,"/halo"),method:"post",timeout:864e4})},listHaloBackups:function(){return Object(l["a"])({url:"".concat(i,"/halo"),method:"get"})},deleteHaloBackup:function(t){return Object(l["a"])({url:"".concat(i,"/halo"),params:{filename:t},method:"delete"})}},c=s,r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("a-card",{attrs:{bordered:!1,bodyStyle:{padding:"16px"}}},[e("div",{attrs:{slot:"title"},slot:"title"},[e("a-icon",{attrs:{type:"hdd"}}),t._v("博客备份\n  ")],1),e("template",{staticClass:"ant-card-actions",slot:"actions"},[e("a-button",{attrs:{type:"link",icon:"download",loading:t.backuping},on:{click:t.handleBackupClick}},[t._v("备份")]),e("a-button",{attrs:{type:"link",icon:"reload",loading:t.loading},on:{click:t.handleBAckupRefreshClick}},[t._v("刷新")])],1),e("a-list",{attrs:{itemLayout:"horizontal",dataSource:t.backupTips},scopedSlots:t._u([{key:"renderItem",fn:function(a){return e("a-list-item",{},[e("a-list-item-meta",{attrs:{description:a.description}},[e("h4",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(a.title))])]),a.alert?e("a-alert",{attrs:{slot:"extra",message:a.alert.message,type:a.alert.type,banner:""},slot:"extra"}):t._e()],1)}}])}),e("a-divider",[t._v("历史备份")]),e("a-list",{attrs:{itemLayout:"vertical",size:"small",dataSource:t.backups},scopedSlots:t._u([{key:"renderItem",fn:function(a){return e("a-list-item",{},[e("a-button",{staticStyle:{color:"red"},attrs:{slot:"extra",type:"link",icon:"delete",loading:t.deleting},on:{click:function(e){return t.handleBackupDeleteClick(a.filename)}},slot:"extra"},[t._v("删除")]),e("a-list-item-meta",[e("a",{attrs:{slot:"title",href:a.downloadUrl},slot:"title"},[e("a-icon",{staticStyle:{color:"#52c41a"},attrs:{type:"schedule"}}),t._v("\n          "+t._s(a.filename)+"\n        ")],1),e("p",{attrs:{slot:"description"},slot:"description"},[t._v(t._s(t._f("timeAgo")(a.updateTime)))])])],1)}}])},[t.loading?e("div",{staticClass:"loading-container"},[e("a-spin")],1):t._e()])],2)},d=[],u={name:"Backup",data:function(){return{backuping:!1,loading:!1,deleting:!1,backups:[],backupTips:[{title:"博客备份",description:"将会压缩 Halo 的工作目录到临时文件中，并提供下载链接。如果附件太多的话，可能会十分耗时，请耐心等待！",alert:{type:"warning",message:"注意：备份后生成的压缩文件存储在临时文件中，重启服务器会造成备份文件的丢失，所以请尽快下载！"}},{title:"备份查询",description:"查询近期的备份，按照备份时间递减排序。"},{title:"备份删除",description:"删除已经备份的内容。"},{title:"版本要求",alert:{type:"warning",message:"注意：要求 Halo server 版本大于 v1.1.1！你可以在 【系统 | 关于】 里面找到系统的版本信息。"}}]}},created:function(){this.getBackups()},methods:{getBackups:function(){var t=this;this.loading=!0,c.listHaloBackups().then((function(a){t.backups=a.data.data})).finally((function(){return t.loading=!1}))},handleBackupClick:function(){var t=this;this.backuping=!0,c.backupHalo().then((function(a){t.$notification.success({message:"Backup succeeded!"}),t.getBackups()})).finally((function(){t.backuping=!1}))},handleBackupDeleteClick:function(t){var a=this;this.deleting=!0,c.deleteHaloBackup(t).then((function(t){a.$notification.success({message:"Delete succeeded!"}),a.getBackups()})).finally((function(){return a.deleting=!1}))},handleBAckupRefreshClick:function(){this.getBackups()}}},p=u,k=(e("a9aa"),e("2877")),m=Object(k["a"])(p,r,d,!1,null,"7c9d3a3a",null),f=m.exports,h={components:{Backup:f},data:function(){return{markdownUpload:!1,uploadHandler:c.importMarkdown}},methods:{handleImportMarkdown:function(){this.markdownUpload=!0},handleChange:function(t){var a=t.file.status;"uploading"!==a&&console.log(t.file,t.fileList),"done"===a?this.$message.success("".concat(t.file.name," 导入成功！")):"error"===a&&this.$message.error("".concat(t.file.name," 导入失败！"))},onUploadClose:function(){this.$refs.upload.handleClearFileList()}}},g=h,b=Object(k["a"])(g,n,o,!1,null,null,null);a["default"]=b.exports}}]);