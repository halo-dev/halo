(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-142c8832"],{a8ed:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-header-index-wide"},[a("a-row",[a("a-col",{attrs:{span:24}},[a("div",{staticClass:"card-container"},[a("a-tabs",{attrs:{type:"card"}},[a("a-tab-pane",{key:"internal"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("a-icon",{attrs:{type:"pushpin"}}),t._v("内置页面\n            ")],1),a("a-table",{attrs:{columns:t.internalColumns,dataSource:t.internalSheets,pagination:!1,rowKey:function(t){return t.id}},scopedSlots:t._u([{key:"action",fn:function(e,n){return a("span",{},[1==n.id?a("router-link",{attrs:{to:{name:"LinkList"}}},[a("a",{attrs:{href:"javascript:void(0);"}},[t._v("管理")])]):t._e(),2==n.id?a("router-link",{attrs:{to:{name:"PhotoList"}}},[a("a",{attrs:{href:"javascript:void(0);"}},[t._v("管理")])]):t._e(),3==n.id?a("router-link",{attrs:{to:{name:"JournalList"}}},[a("a",{attrs:{href:"javascript:void(0);"}},[t._v("管理")])]):t._e(),a("a-divider",{attrs:{type:"vertical"}}),a("a",{attrs:{href:t.options.blog_url+n.url,target:"_blank"}},[t._v("查看")])],1)}}])})],1),a("a-tab-pane",{key:"custom"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("a-icon",{attrs:{type:"fork"}}),t._v("自定义页面\n            ")],1),a("a-table",{attrs:{rowKey:function(t){return t.id},columns:t.customColumns,dataSource:t.formattedSheets,pagination:!1},scopedSlots:t._u([{key:"status",fn:function(e){return a("span",{},[a("a-badge",{attrs:{status:e.status}}),t._v("\n                "+t._s(e.text)+"\n              ")],1)}},{key:"updateTime",fn:function(e){return a("span",{},[t._v(t._s(t._f("timeAgo")(e)))])}},{key:"action",fn:function(e,n){return a("span",{},["PUBLISHED"===n.status||"DRAFT"===n.status?a("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.handleEditClick(n)}}},[t._v("编辑")]):"RECYCLE"===n.status?a("a-popconfirm",{attrs:{title:"你确定要发布【"+n.title+"】？",okText:"确定",cancelText:"取消"},on:{confirm:function(e){return t.handleEditStatusClick(n.id,"PUBLISHED")}}},[a("a",{attrs:{href:"javascript:;"}},[t._v("还原")])]):t._e(),a("a-divider",{attrs:{type:"vertical"}}),"PUBLISHED"===n.status||"DRAFT"===n.status?a("a-popconfirm",{attrs:{title:"你确定要将【"+n.title+"】页面移到回收站？",okText:"确定",cancelText:"取消"},on:{confirm:function(e){return t.handleEditStatusClick(n.id,"RECYCLE")}}},[a("a",{attrs:{href:"javascript:;"}},[t._v("回收站")])]):"RECYCLE"===n.status?a("a-popconfirm",{attrs:{title:"你确定要永久删除【"+n.title+"】页面？",okText:"确定",cancelText:"取消"},on:{confirm:function(e){return t.handleDeleteClick(n.id)}}},[a("a",{attrs:{href:"javascript:;"}},[t._v("删除")])]):t._e()],1)}}])})],1)],1)],1)])],1)],1)},s=[],o=(a("612f"),a("ac0d")),r=a("ed66"),i=a("482b"),u=[{title:"页面名称",dataIndex:"name"},{title:"访问路径",dataIndex:"url"},{title:"状态",dataIndex:"status"},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],c=[{title:"标题",dataIndex:"title"},{title:"状态",className:"status",dataIndex:"statusProperty",scopedSlots:{customRender:"status"}},{title:"评论量",dataIndex:"commentCount"},{title:"访问量",dataIndex:"visits"},{title:"更新时间",dataIndex:"updateTime",scopedSlots:{customRender:"updateTime"}},{title:"操作",width:"150px",scopedSlots:{customRender:"action"}}],d=[{id:"1",name:"友情链接",url:"/links",status:"可用"},{id:"2",name:"图库页面",url:"/photos",status:"可用"},{id:"3",name:"日志页面",url:"/journals",status:"实验性"}],l={mixins:[o["a"],o["b"]],data:function(){return{sheetStatus:r["a"].sheetStatus,internalColumns:u,customColumns:c,internalSheets:d,sheets:[],options:[],keys:["blog_url"]}},computed:{formattedSheets:function(){var t=this;return this.sheets.map(function(e){return e.statusProperty=t.sheetStatus[e.status],e})}},created:function(){this.loadSheets(),this.loadOptions()},methods:{loadSheets:function(){var t=this;r["a"].list().then(function(e){t.sheets=e.data.data.content})},loadOptions:function(){var t=this;i["a"].listAll(this.keys).then(function(e){t.options=e.data.data})},handleEditClick:function(t){this.$router.push({name:"SheetEdit",query:{sheetId:t.id}})},handleEditStatusClick:function(t,e){var a=this;r["a"].updateStatus(t,e).then(function(t){a.$message.success("操作成功！"),a.loadSheets()})},handleDeleteClick:function(t){var e=this;r["a"].delete(t).then(function(t){e.$message.success("删除成功！"),e.loadSheets()})}}},p=l,h=a("17cc"),f=Object(h["a"])(p,n,s,!1,null,null,null);e["default"]=f.exports},ed66:function(t,e,a){"use strict";var n=a("9efd"),s="/api/admin/sheets",o={list:function(){return Object(n["a"])({url:s,method:"get"})},get:function(t){return Object(n["a"])({url:"".concat(s,"/").concat(t),method:"get"})},create:function(t,e){return Object(n["a"])({url:s,method:"post",data:t,params:{autoSave:e}})},update:function(t,e,a){return Object(n["a"])({url:"".concat(s,"/").concat(t),method:"put",data:e,params:{autoSave:a}})},updateStatus:function(t,e){return Object(n["a"])({url:"".concat(s,"/").concat(t,"/").concat(e),method:"put"})},delete:function(t){return Object(n["a"])({url:"".concat(s,"/").concat(t),method:"delete"})},sheetStatus:{PUBLISHED:{color:"green",status:"success",text:"已发布"},DRAFT:{color:"yellow",status:"warning",text:"草稿"},RECYCLE:{color:"red",status:"error",text:"回收站"}}};e["a"]=o}}]);